<!DOCTYPE html><html lang="zh-CN"><head><link rel="stylesheet" href="/css/bilicard.css"><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="keywords" content="空中有零，零域，分享快乐，音乐，心得，生活，电影，代码，编程，考试，学业，零式的天空，凌空博客，原零空博客，原Tans博客，现零的小屋官方博客，计算机，音乐，电脑，编程，生活，分享"><meta name="description" content="一个技术控，爱技术，爱分享，爱音乐"><meta name="author" content="Pin Young"><script defer data-pjax src="/js/iosurl.js"></script><title>C++命令行解析库CLI11介绍 | 零域</title><link rel="stylesheet" href="/css/style.css"><link rel="shortcut icon" href="/img/favicon.png"><link rel="stylesheet" href="/font/css/fontawesome.min.css"><link rel="stylesheet" href="/font/css/regular.min.css"><link rel="stylesheet" href="/font/css/solid.min.css"><link rel="stylesheet" href="/font/css/brands.min.css"><script id="hexo-configurations">let KEEP=window.KEEP||{};KEEP.hexo_config={hostname:"0skyu.cn",root:"/",language:"zh-CN",path:"search.xml"},KEEP.theme_config={toc:{enable:!0,number:!0,expand_all:!0,init_open:!0},style:{primary_color:"#EE5A24",logo:"/img/favicon.png",favicon:"/img/favicon.png",avatar:"img/1.jpg",font_size:null,font_family:null,hover:{shadow:!0,scale:!1},first_screen:{enable:!0,header_transparent:!1,background_img:"/img/bg/333.jpg",description:"Keep writing and Keep loving.",font_color:"#f0d21a",hitokoto:!0},scroll:{progress_bar:!0,percent:!1}},local_search:{enable:!0,preload:!0},code_copy:{},code_block:{tools:{enable:!0,style:"default"},highlight_theme:"default"},side_tools:{},pjax:{enable:!0},lazyload:{enable:!0},comment:{enable:!1,use:"gitalk",valine:{appid:null,appkey:null,server_urls:null,placeholder:null},gitalk:{github_id:"DsTansice",github_admins:"DsTansice",repository:"Null-Comment",client_id:"b109b534b2268088d780",client_secret:"7808e138a1ffbcd9f02bb39cc1ee7fb41828c52f",proxy:null},twikoo:{env_id:"twikoo-0skyucn-1gkzaji32bb03146",region:null,version:"1.6.8"},waline:{server_url:null,reaction:!1,version:2}},post:{author_label:{enable:!0,auto:!0,custom_label_list:["Trainee","Engineer","Architect"]},word_count:{enable:!0,wordcount:!0,min2read:!0},img_align:"left",copyright_info:!0},version:"3.6.1"},KEEP.language_ago={second:"%s 秒前",minute:"%s 分钟前",hour:"%s 小时前",day:"%s 天前",week:"%s 周前",month:"%s 个月前",year:"%s 年前"},KEEP.language_code_block={copy:"复制代码",copied:"已复制",fold:"折叠代码块",folded:"已折叠"},KEEP.language_copy_copyright={copy:"复制版权信息",copied:"已复制",title:"原文标题",author:"原文作者",link:"原文链接"}</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="零域" type="application/atom+xml">
</head><body><div class="progress-bar-container"><span class="scroll-progress-bar"></span> <span class="pjax-progress-bar"></span> <i class="pjax-progress-icon fas fa-circle-notch fa-spin"></i></div><main class="page-container"><div class="page-main-content"><div class="page-main-content-top"><header class="header-wrapper"><div class="header-content"><div class="left"><a class="logo-image" href="/"><img src="/img/favicon.png"> </a><a class="logo-title" href="/">零域</a></div><div class="right"><div class="pc"><ul class="menu-list"><li class="menu-item"><a href="/">首页</a></li><li class="menu-item"><a href="/archives">归档</a></li><li class="menu-item"><a href="/tags">标签</a></li><li class="menu-item"><a href="/categories">分类</a></li><li class="menu-item"><a href="/links">友链</a></li><li class="menu-item"><a target="_blank" rel="noopener" href="https://hao.0skyu.cn/">HAO</a></li><li class="menu-item search search-popup-trigger"><i class="fas fa-search"></i></li></ul></div><div class="mobile"><div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div><div class="icon-item menu-bar"><div class="menu-bar-middle"></div></div></div></div></div><div class="header-drawer"><ul class="drawer-menu-list"><li class="drawer-menu-item flex-center"><a href="/">首页</a></li><li class="drawer-menu-item flex-center"><a href="/archives">归档</a></li><li class="drawer-menu-item flex-center"><a href="/tags">标签</a></li><li class="drawer-menu-item flex-center"><a href="/categories">分类</a></li><li class="drawer-menu-item flex-center"><a href="/links">友链</a></li><li class="drawer-menu-item flex-center"><a target="_blank" rel="noopener" href="https://hao.0skyu.cn/">HAO</a></li></ul></div><div class="window-mask"></div></header></div><div class="page-main-content-middle"><div class="main-content"><div class="fade-in-down-animation"><div class="post-page-container"><div class="article-content-container"><div class="article-title"><span class="title-hover-animation">C++命令行解析库CLI11介绍</span></div><div class="article-header"><div class="avatar"><img src="/img/1.jpg"></div><div class="info"><div class="author"><span class="name">Pin Young</span> <span class="author-label">Lv9</span></div><div class="meta-info"><div class="article-meta-info"><span class="article-date article-meta-item"><i class="fa-regular fa-calendar-plus"></i>&nbsp; <span class="pc">2020-03-04 20:11:12</span> <span class="mobile">2020-03-04 20:11</span> </span><span class="article-update-date article-meta-item"><i class="fas fa-file-pen"></i>&nbsp; <span class="pc">2023-02-05 21:25:09</span> </span><span class="article-tags article-meta-item"><i class="fas fa-tags"></i>&nbsp;<ul><li><a href="/tags/C-CLI11-%E5%91%BD%E4%BB%A4%E8%A1%8C%E8%A7%A3%E6%9E%90/">C++ CLI11 命令行解析</a>&nbsp;</li></ul></span><span class="article-wordcount article-meta-item"><i class="fas fa-file-word"></i>&nbsp;<span>2.1k 字</span> </span><span class="article-min2read article-meta-item"><i class="fas fa-clock"></i>&nbsp;<span>9 分钟</span> </span><span class="article-pv article-meta-item"><i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span></span></div></div></div></div><div class="article-content keep-markdown-body"><p>本篇文章主要提炼自github上CLI11的官方文档,取出自己感兴趣的内容,记录下来方便以后使用</p><h2 id="简单介绍"><a href="#简单介绍" class="headerlink" title="简单介绍"></a>简单介绍</h2><p>CLI11是一个基于C++开发的命令行解析库,目前最新版本1.9</p><p>其优点:</p><ul><li>使用很方便,只需要<code>#include &lt;CLI11.hpp&gt;</code>,当然也可以使用cmake编译版本</li><li>跨平台,支持广泛(不需要C++11以上的版本支持)</li><li>支持subcommand;支持重复options</li></ul><p>关于编译</p><blockquote><p><code>g++ -std=c++11 xx.cpp -I path_with_CLI11 -o app</code></p></blockquote><p>(path_with_CLI11是一个路径,其内有CLI11.hpp, app是编译后的可执行程序名)</p><p>运行:</p><p>需要提示信息的时候运行<code>./app -h</code></p><h3 id="一个简单的例子"><a href="#一个简单的例子" class="headerlink" title="一个简单的例子"></a>一个简单的例子</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CLI11.hpp&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    CLI::App app&#123;<span class="string">&quot;App description&quot;</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Define options</span></span><br><span class="line">    <span class="type">int</span> p = <span class="number">0</span>;</span><br><span class="line">    app.<span class="built_in">add_option</span>(<span class="string">&quot;-p&quot;</span>, p, <span class="string">&quot;Parameter&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">CLI11_PARSE</span>(app, argc, argv);</span><br><span class="line"></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Parameter value: &quot;</span> &lt;&lt; p &lt;&lt; std::endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>只接受一个可选参数-p</p><p>CLI::App 是与库的所有交互的基础</p><p>CLI11_PARSE 宏内部执行app.parse(argc,argv)对命令行参数解析,出错时抛出ParseError,然后捕获异常,打印错误信息并退出程序</p><h2 id="主要功能"><a href="#主要功能" class="headerlink" title="主要功能"></a>主要功能</h2><h3 id="位置参数"><a href="#位置参数" class="headerlink" title="位置参数"></a>位置参数</h3><p>即必须参数,使用方法是<em>add_xxx</em>方法的第一个参数如”-a” <strong>把”-“ 去掉</strong>,换成有意义的名字,如”outputDir”<br>位置参数就是没有这些参数就无法运行,没有默认值;多个位置参数按定义顺序传递</p><h3 id="flags"><a href="#flags" class="headerlink" title="flags"></a>flags</h3><p>命令行输入只填flag名字就行,不接受参数;函数为<em>add_flag</em>,有以下三种类型:</p><ul><li><p>boolean flags</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span> my_flag;</span><br><span class="line">app.<span class="built_in">add_flag</span>(<span class="string">&quot;-f&quot;</span>, my_flag, <span class="string">&quot;Optional description&quot;</span>);</span><br></pre></td></tr></table></figure><p>绑定flag -f 到布尔变量my_flag,默认是flase,如果用户输入了-f 则为true</p></li><li><p>integer flags</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> my_flag;</span><br><span class="line">app.<span class="built_in">add_flag</span>(<span class="string">&quot;-f&quot;</span>, my_flag, <span class="string">&quot;Optional description&quot;</span>);</span><br></pre></td></tr></table></figure><p>同样的绑定,范围变成整数</p></li><li><p>pure flags</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CLI::Option* my_flag = app.<span class="built_in">add_flag</span>(<span class="string">&quot;-f&quot;</span>, <span class="string">&quot;Optional description&quot;</span>);</span><br></pre></td></tr></table></figure><p>使用my_flag-&gt;count()来确定值是true&#x2F;false,默认为0则false,大于等于1次则true;也可以bool(*my_flag)来使用</p><p>所有add_* 格式的函数都返回CLI::Option类型,因此可以<strong>链式调用</strong>,使代码更简约</p></li><li><p>其他<br>有callback flags,add_flag_function()可以打印每个参数输入了多少次</p></li></ul><p>每个add_*方法的第一个参数,即指定的命令参数,可以有多个名字,逗号分隔即可,如”-a,–alpha,-b”;另外一个比较有用的是-&gt;ignore_case() 方法,忽略大小写,方便用户输入</p><p>多个参数可以组合如”-i -a -b”等价于”-iab”</p><h3 id="options"><a href="#options" class="headerlink" title="options"></a>options</h3><p>与flags区别就是<strong>接受参数</strong>;函数为<em>add_option</em></p><p>基本形式:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> int_option = <span class="number">0</span>;</span><br><span class="line">app.<span class="built_in">add_option</span>(<span class="string">&quot;-i&quot;</span>, int_option, <span class="string">&quot;Optional description&quot;</span>);</span><br></pre></td></tr></table></figure><p>其行为:绑定选项-i到int_option,解析其后的数据转换为整型,类型不对会失败;如果没有此选项则使用初始值</p><p>可接受类型包括:整型&#x2F;浮点&#x2F;字符串&#x2F;vector&#x2F;函数</p><h3 id="vectors-of-options"><a href="#vectors-of-options" class="headerlink" title="vectors of options"></a>vectors of options</h3><p>接受多个值,直到下一个值不合法;也可以用-&gt;expected(N)指定需要几个值</p><p>如果出现重复option,会进行组合,即”-v 1 2 -v 3 4”等同于”-v 1 2 3 4”(新版本才支持此功能)</p><h3 id="修改option属性"><a href="#修改option属性" class="headerlink" title="修改option属性"></a>修改option属性</h3><p>链式使用,当作装饰器,可以同时添加多个装饰</p><p>列举几个可能会常用到的:</p><ul><li>-&gt;required() 必须指定</li><li>-&gt;expected(N) 参数个数</li><li>-&gt;check(type)<ul><li>CLI::ExistingFile 检查文件是否存在</li><li>CLI::ExistingDirectory 目录是否存在</li><li>CLI::NonexistentPath 需要目录不存在</li><li>CLI::Range(min,max) 指定范围</li></ul></li></ul><h3 id="特殊选项"><a href="#特殊选项" class="headerlink" title="特殊选项:"></a>特殊选项:</h3><ul><li><em>sets</em><br>使用集合来限定输入范围;如果输入不在集合范围内,会打印提示信息<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> val;</span><br><span class="line">app.<span class="built_in">add_set</span>(<span class="string">&quot;--even&quot;</span>, val, &#123;<span class="number">0</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">8</span>&#125;);</span><br></pre></td></tr></table></figure></li><li><em>complex number</em> 复数,可接受1-2个参数,不给默认是0<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">std::complex&lt;<span class="type">float</span>&gt; val;</span><br><span class="line">app.<span class="built_in">add_complex</span>(<span class="string">&quot;--cplx&quot;</span>, val);</span><br></pre></td></tr></table></figure></li><li><em>optional</em> 可选参数</li><li><em>windows风格</em> &#x2F;a &#x2F;f …</li></ul><h3 id="Validators-验证器"><a href="#Validators-验证器" class="headerlink" title="Validators 验证器"></a>Validators 验证器</h3><p>验证器有两种形式</p><ul><li>transform 变异? 接受string,返回修改过的string</li><li>check 非变异?<ul><li>接受const string,返回修改过的string</li><li>struct CLI::Validator的子类<br>常用check来检查路径&#x2F;文件是否存在,以及输入是否在一个range内</li></ul></li></ul><h2 id="subcommand-子命令"><a href="#subcommand-子命令" class="headerlink" title="subcommand 子命令"></a>subcommand 子命令</h2><p>子命令就是包含了一系列选项的一个关键字,如git commit&#x2F;clone 这里面的commit clone后面还可以跟各种选项,他们就是git程序的子命令</p><p>子命令的类类型和App相同,因此可以任意嵌套</p><p>关于App的功能</p><ul><li>使用它来创建options</li><li>设置页脚,在-h下面展示,比如显示下个性签名 app.footer(“xx”)</li><li>设置帮助信息</li></ul><h3 id="添加子命令"><a href="#添加子命令" class="headerlink" title="添加子命令"></a>添加子命令</h3><p><code>CLI::App* sub = app.add_subcommand(&quot;sub&quot;, &quot;This is a subcommand&quot;);</code></p><p>第一个参数就是子命令的名字,第二个参数是描述</p><h3 id="检查子命令是否被使用"><a href="#检查子命令是否被使用" class="headerlink" title="检查子命令是否被使用"></a>检查子命令是否被使用</h3><ul><li>if(*sub) …</li><li>if(sub-&gt;parsed()) …</li><li>if(app.got_subcommand(sub)) …</li><li>if(app.got_subcommand(“sub”)) …</li></ul><p>设置必须的子命令个数,只传一个参数则限定了个数<br>app.require_subcommand(&#x2F;* min <em>&#x2F; 0, &#x2F;</em> max *&#x2F; 1);</p><h3 id="特殊模式"><a href="#特殊模式" class="headerlink" title="特殊模式"></a>特殊模式</h3><ul><li>allow_extras() 允许出现多余的option而不报错,多余的值保存到.remaining()</li><li>fallthrough 将subcommand未匹配的option转给parnet command解析(默认不会fallthrough)</li><li>prefix command 遇到未知option时停止解析,即使其他未知选项可以匹配,也将被忽略</li></ul><h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><p>编写个实例,把subcommand flag 各种option,check等常用功能都演示一遍</p><p>代码:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//把CLI11.hpp放到当前目录下</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CLI11.hpp&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    CLI::App app&#123;<span class="string">&quot;App description&quot;</span>&#125;; <span class="comment">// 软件描述出现在第一行打印</span></span><br><span class="line">    app.<span class="built_in">footer</span>(<span class="string">&quot;My footer&quot;</span>); <span class="comment">// 最后一行打印</span></span><br><span class="line">    app.<span class="built_in">get_formatter</span>()-&gt;<span class="built_in">column_width</span>(<span class="number">40</span>); <span class="comment">// 列的宽度</span></span><br><span class="line">    app.<span class="built_in">require_subcommand</span>(<span class="number">1</span>); <span class="comment">// 表示运行命令需要且仅需要一个子命令</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> sub1 = app.<span class="built_in">add_subcommand</span>(<span class="string">&quot;sub1&quot;</span>, <span class="string">&quot;subcommand1&quot;</span>);</span><br><span class="line">    <span class="keyword">auto</span> sub2 = app.<span class="built_in">add_subcommand</span>(<span class="string">&quot;sub2&quot;</span>, <span class="string">&quot;subcommand1&quot;</span>);</span><br><span class="line">    sub1-&gt;<span class="built_in">fallthrough</span>(); <span class="comment">// 当出现的参数子命令解析不了时,返回上一级尝试解析</span></span><br><span class="line">    sub2-&gt;<span class="built_in">fallthrough</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义需要用到的参数</span></span><br><span class="line">    string filename;</span><br><span class="line">    <span class="type">int</span> threads = <span class="number">10</span>;</span><br><span class="line">    <span class="type">int</span> mode = <span class="number">0</span>;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; barcodes;</span><br><span class="line">    <span class="type">bool</span> reverse = <span class="literal">false</span>;</span><br><span class="line">    string outPath;</span><br><span class="line">    <span class="keyword">if</span> (sub1)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 第一个参数不加-, 表示位置参数,位置参数按出现的顺序来解析</span></span><br><span class="line">        <span class="comment">// 这里还检查了文件是否存在,已经是必须参数</span></span><br><span class="line">        sub1-&gt;<span class="built_in">add_option</span>(<span class="string">&quot;file&quot;</span>, filename, <span class="string">&quot;Position paramter&quot;</span>)-&gt;<span class="built_in">check</span>(CLI::ExistingFile)-&gt;<span class="built_in">required</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 检查参数必须大于0</span></span><br><span class="line">        sub1-&gt;<span class="built_in">add_option</span>(<span class="string">&quot;-n,-N&quot;</span>, threads, <span class="string">&quot;Set thread number&quot;</span>)-&gt;<span class="built_in">check</span>(CLI::PositiveNumber);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (sub2)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 设置范围</span></span><br><span class="line">        sub2-&gt;<span class="built_in">add_option</span>(<span class="string">&quot;-e,-E&quot;</span>, mode, <span class="string">&quot;Set mode&quot;</span>)-&gt;<span class="built_in">check</span>(CLI::<span class="built_in">Range</span>(<span class="number">0</span>,<span class="number">3</span>));</span><br><span class="line">        <span class="comment">// 将数据放到vector中,并限制可接受的长度</span></span><br><span class="line">        sub2-&gt;<span class="built_in">add_option</span>(<span class="string">&quot;-b&quot;</span>, barcodes, <span class="string">&quot;Barcodes info:start,len,mismatch&quot;</span>)-&gt;<span class="built_in">expected</span>(<span class="number">3</span>,<span class="number">6</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 添加flag,有就是true</span></span><br><span class="line">    app.<span class="built_in">add_flag</span>(<span class="string">&quot;-r,-R&quot;</span>, reverse, <span class="string">&quot;Apply reverse&quot;</span>);</span><br><span class="line">    <span class="comment">// 检查目录是否存在</span></span><br><span class="line">    app.<span class="built_in">add_option</span>(<span class="string">&quot;-o&quot;</span>, outPath, <span class="string">&quot;Output path&quot;</span>)-&gt;<span class="built_in">check</span>(CLI::ExistingDirectory);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">CLI11_PARSE</span>(app, argc, argv);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 判断哪个子命令被使用</span></span><br><span class="line">    <span class="keyword">if</span> (sub1-&gt;<span class="built_in">parsed</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;Got sub1&quot;</span>&lt;&lt;endl;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;filename:&quot;</span>&lt;&lt;filename&lt;&lt;endl;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;threads:&quot;</span>&lt;&lt;threads&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (sub2-&gt;<span class="built_in">parsed</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;Got sub2&quot;</span>&lt;&lt;endl;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;mode:&quot;</span>&lt;&lt;mode&lt;&lt;endl;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;barcodes:&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; b : barcodes)</span><br><span class="line">            cout&lt;&lt;b&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">        cout&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;endl&lt;&lt;<span class="string">&quot;Comman paras&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;reverse:&quot;</span>&lt;&lt;reverse&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;outPath:&quot;</span>&lt;&lt;outPath&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>编译:<br><code>g++ -std=c++11 run.cpp -o myapp</code></p><p>用的gcc4.8</p><p>运行:</p><p>-h 查看提示</p><p><img lazyload alt="image" data-src="/images/introduce_CLI11/prompt2.png"></p><p><img lazyload alt="image" data-src="/images/introduce_CLI11/prompt1.png"></p><p><img lazyload alt="image" data-src="/images/introduce_CLI11/prompt3.png"></p><p>给正确的参数</p><p><img lazyload alt="image" data-src="/images/introduce_CLI11/right1.png"></p><p><img lazyload alt="image" data-src="/images/introduce_CLI11/right2.png"></p><p>给错误参数</p><p><img lazyload alt="image" data-src="/images/introduce_CLI11/error3.png"></p><p><img lazyload alt="image" data-src="/images/introduce_CLI11/error4.png"></p><p><img lazyload alt="image" data-src="/images/introduce_CLI11/error1.png"></p><p><img lazyload alt="image" data-src="/images/introduce_CLI11/error2.png"></p><p><img lazyload alt="image" data-src="/images/introduce_CLI11/error5.png"></p><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><p>允许读写配置文件</p><h3 id="格式化帮助信息"><a href="#格式化帮助信息" class="headerlink" title="格式化帮助信息"></a>格式化帮助信息</h3><p>允许定制自己的帮助打印信息<br>app.get_formatter() 获取当前格式</p><ul><li>column_width(width) 设置列的宽度</li><li>lable(key, value) 将lable设置一个不同的值</li><li>例子<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="built_in">get_formatter</span>()-&gt;<span class="built_in">column_width</span>(<span class="number">40</span>);</span><br><span class="line">app.<span class="built_in">get_formatter</span>()-&gt;<span class="built_in">label</span>(<span class="string">&quot;REQUIRED&quot;</span>, <span class="string">&quot;(MUST HAVE)&quot;</span>);</span><br></pre></td></tr></table></figure></li></ul><h3 id="subclassing"><a href="#subclassing" class="headerlink" title="subclassing"></a>subclassing</h3><p>部分的替换格式</p><h2 id="高级主题"><a href="#高级主题" class="headerlink" title="高级主题"></a>高级主题</h2><h3 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h3><p>作用是,如果命令行参数没有给定,则从环境变量中获取,如果存在的话</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">std::string opt;</span><br><span class="line">app.<span class="built_in">add_option</span>(<span class="string">&quot;--my_option&quot;</span>, opt)-&gt;<span class="built_in">envname</span>(<span class="string">&quot;MY_OPTION&quot;</span>);</span><br></pre></td></tr></table></figure><h3 id="option之间的依赖-x2F-互斥关系"><a href="#option之间的依赖-x2F-互斥关系" class="headerlink" title="option之间的依赖&#x2F;互斥关系"></a>option之间的依赖&#x2F;互斥关系</h3><p>a-&gt;nees(b) a依赖b</p><p>a-&gt;excludes(c) a与c不共存</p><h3 id="自定义"><a href="#自定义" class="headerlink" title="自定义"></a>自定义</h3><p>custom option callbacks</p><p>custom converters</p></div><div class="post-copyright-info"><div class="article-copyright-info-container"><ul class="copyright-info-content"><li class="post-title"><span class="type">本文标题</span>：<span class="content">C++命令行解析库CLI11介绍</span></li><li class="post-author"><span class="type">本文作者</span>：<span class="content">Pin Young</span></li><li class="post-time"><span class="type">创建时间</span>：<span class="content">2020-03-04 20:11:12</span></li><li class="post-link"><span class="type">本文链接</span>：<span class="content">posts/f89e.html</span></li><li class="post-license"><span class="type">版权声明</span>：<span class="content">本博客所有文章除特别声明外，均采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> 许可协议。转载请注明出处！</span></li></ul><div class="copy-copyright-info flex-center tooltip" data-content="复制版权信息" data-offset-y="-2px"><i class="fa-solid fa-copy"></i></div></div></div><ul class="post-tags-box"><li class="tag-item"><a href="/tags/C-CLI11-%E5%91%BD%E4%BB%A4%E8%A1%8C%E8%A7%A3%E6%9E%90/">#C++ CLI11 命令行解析</a>&nbsp;</li></ul><div class="article-nav"><div class="article-prev"><a class="prev" rel="prev" href="/posts/fe19.html"><span class="left arrow-icon flex-center"><i class="fas fa-chevron-left"></i> </span><span class="title flex-center"><span class="post-nav-title-item">解决hexo博客文章太长导致的显示不全问题</span> <span class="post-nav-item">上一篇</span></span></a></div><div class="article-next"><a class="next" rel="next" href="/posts/57fa.html"><span class="title flex-center"><span class="post-nav-title-item">CUDA C/C++总结</span> <span class="post-nav-item">下一篇</span> </span><span class="right arrow-icon flex-center"><i class="fas fa-chevron-right"></i></span></a></div></div></div><div class="toc-content-container"><div class="post-toc-wrap"><div class="post-toc"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%80%E5%8D%95%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.</span> <span class="nav-text">简单介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E4%BE%8B%E5%AD%90"><span class="nav-number">1.1.</span> <span class="nav-text">一个简单的例子</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%BB%E8%A6%81%E5%8A%9F%E8%83%BD"><span class="nav-number">2.</span> <span class="nav-text">主要功能</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%8D%E7%BD%AE%E5%8F%82%E6%95%B0"><span class="nav-number">2.1.</span> <span class="nav-text">位置参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#flags"><span class="nav-number">2.2.</span> <span class="nav-text">flags</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#options"><span class="nav-number">2.3.</span> <span class="nav-text">options</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#vectors-of-options"><span class="nav-number">2.4.</span> <span class="nav-text">vectors of options</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9option%E5%B1%9E%E6%80%A7"><span class="nav-number">2.5.</span> <span class="nav-text">修改option属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%89%B9%E6%AE%8A%E9%80%89%E9%A1%B9"><span class="nav-number">2.6.</span> <span class="nav-text">特殊选项:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Validators-%E9%AA%8C%E8%AF%81%E5%99%A8"><span class="nav-number">2.7.</span> <span class="nav-text">Validators 验证器</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#subcommand-%E5%AD%90%E5%91%BD%E4%BB%A4"><span class="nav-number">3.</span> <span class="nav-text">subcommand 子命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0%E5%AD%90%E5%91%BD%E4%BB%A4"><span class="nav-number">3.1.</span> <span class="nav-text">添加子命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E6%9F%A5%E5%AD%90%E5%91%BD%E4%BB%A4%E6%98%AF%E5%90%A6%E8%A2%AB%E4%BD%BF%E7%94%A8"><span class="nav-number">3.2.</span> <span class="nav-text">检查子命令是否被使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%89%B9%E6%AE%8A%E6%A8%A1%E5%BC%8F"><span class="nav-number">3.3.</span> <span class="nav-text">特殊模式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E4%BE%8B"><span class="nav-number">4.</span> <span class="nav-text">实例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B6%E4%BB%96"><span class="nav-number">5.</span> <span class="nav-text">其他</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">5.1.</span> <span class="nav-text">配置文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%B8%AE%E5%8A%A9%E4%BF%A1%E6%81%AF"><span class="nav-number">5.2.</span> <span class="nav-text">格式化帮助信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#subclassing"><span class="nav-number">5.3.</span> <span class="nav-text">subclassing</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%AB%98%E7%BA%A7%E4%B8%BB%E9%A2%98"><span class="nav-number">6.</span> <span class="nav-text">高级主题</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="nav-number">6.1.</span> <span class="nav-text">环境变量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#option%E4%B9%8B%E9%97%B4%E7%9A%84%E4%BE%9D%E8%B5%96-x2F-%E4%BA%92%E6%96%A5%E5%85%B3%E7%B3%BB"><span class="nav-number">6.2.</span> <span class="nav-text">option之间的依赖&#x2F;互斥关系</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89"><span class="nav-number">6.3.</span> <span class="nav-text">自定义</span></a></li></ol></li></ol></div></div></div></div></div></div></div><div class="page-main-content-bottom"><footer class="footer"><div class="info-container"><div class="copyright-info info-item">&copy; <span>2014</span> - 2023 &nbsp;<i class="fas fa-heart icon-animate"></i> &nbsp;<a href="/">Pin Young</a></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="website-count info-item">访问人数&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp; 总访问量&nbsp;<span id="busuanzi_value_site_pv"></span></div><div class="theme-info info-item">由 <a target="_blank" href="https://hexo.io">Hexo</a> 驱动&nbsp;|&nbsp;主题&nbsp;<a class="theme-version" target="_blank" href="https://github.com/dstansice">零域Lite 1.3.1</a></div><script async defer data-website-id="b3b1feba-ef0f-4367-ba34-6a0152b8749b" src="https://analysis.0skyu.cn/umami.js"></script><div class="icp-info info-item"><div class="theme-info info-item"><a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=12011002021027" style="display:inline-block;text-decoration:none;height:20px;line-height:20px"><img src="https://0skyu.cn/beian.png" style="float:left"><p style="float:left;height:20px;line-height:20px;margin:0 0 0 5px;color:#939393">津公网安备 12011002021027号</p></a></div><div class="theme-info info-item"><center><a target="_blank" rel="nofollow" href="https://beian.miit.gov.cn">津ICP备2021004482号-1</a></center></div></div><div class="deploy-info info-item"><a target="_blank" rel="nofollow" href="https://hao.0skyu.cn/">本站由 <span class="tooltip" data-content="腾讯云"><img src="/images/deploy-provider/tencent_cloud.png"></span>提供部署服务</a></div></div></footer></div></div><div class="post-tools"><div class="post-tools-container"><ul class="tools-list"><li class="tools-item flex-center toggle-show-toc"><i class="fas fa-list"></i></li></ul></div></div><div class="right-bottom-side-tools"><div class="side-tools-container"><ul class="side-tools-list"><li class="tools-item tool-font-adjust-plus flex-center"><i class="fas fa-search-plus"></i></li><li class="tools-item tool-font-adjust-minus flex-center"><i class="fas fa-search-minus"></i></li><li class="tools-item tool-dark-light-toggle flex-center"><i class="fas fa-moon"></i></li><li class="tools-item rss flex-center"><a class="flex-center" href="/atom.xml" target="_blank"><i class="fas fa-rss"></i></a></li><li class="tools-item tool-scroll-to-top flex-center"><i class="fas fa-arrow-up"></i></li><li class="tools-item tool-scroll-to-bottom flex-center"><i class="fas fa-arrow-down"></i></li></ul><ul class="exposed-tools-list"><li class="tools-item tool-toggle-show flex-center"><i class="fas fa-cog fa-spin"></i></li></ul></div></div><div class="zoom-in-image-mask"><img class="zoom-in-image"></div><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-input-field-pre"><i class="fas fa-keyboard"></i></span><div class="search-input-container"><input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="close-popup-btn"><i class="fas fa-times"></i></span></div><div id="search-result"><div id="no-result"><i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></main><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/header-shrink.js"></script><script src="/js/back2top.js"></script><script src="/js/dark-light-toggle.js"></script><script src="/js/local-search.js"></script><script src="/js/code-block.js"></script><script src="/js/lazyload.js"></script><div class="post-scripts pjax"><script src="/js/post-helper.js"></script><script src="/js/libs/anime.min.js"></script><script src="/js/toc.js"></script></div><script src="/js/libs/pjax.min.js"></script><script>window.addEventListener("DOMContentLoaded",()=>{window.pjax=new Pjax({selectors:["head title",".page-container",".pjax"],history:!0,debug:!1,cacheBust:!1,timeout:0,analytics:!1,currentUrlFullReload:!1,scrollRestoration:!1}),document.addEventListener("pjax:send",()=>{KEEP.utils.pjaxProgressBarStart()}),document.addEventListener("pjax:complete",()=>{KEEP.utils.pjaxProgressBarEnd(),window.pjax.executeScripts(document.querySelectorAll("script[data-pjax], .pjax script")),KEEP.refresh()})})</script></body></html>