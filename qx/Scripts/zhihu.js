const scriptName="知乎助手",blockedUsersKey="zhihu_blocked_users",currentUserInfoKey="zhihu_current_userinfo",keywordBlockKey="zhihu_keyword_block",defaultAnswerBlockedUsers=["会员推荐"],keywordMaxCount=1e3,$=MagicJS(scriptName,"INFO");function removeMarketingMsg(){let e=null;try{var t,r,i=JSON.parse($.response.body),o=[];for(t of i.data)"官方帐号消息"===t.detail_title?(r=t.unread_count,t.content.text=0<r?"未读消息"+r+"条":"全部消息已读",t.is_read=!0,t.unread_count=0,o.push(t)):"知乎活动助手"!==t.detail_title&&o.push(t);i.data=o,e={body:JSON.stringify(i)}}catch(e){$.logger.error("知乎屏蔽官方营销消息出现异常："+e)}return e}function unlockBlockedKeywords(){let i=null;try{var o=getUserInfo();if("GET"===$.request.method){let e=$.data.read(keywordBlockKey,null,o.id);e=e||[];var t={"Cache-Control":"no-cache, no-store, must-revalidate, private, max-age=0",Connection:"keep-alive","Content-Type":"application/json;charset=utf-8",Pragma:"no-cache","Referrer-Policy":"no-referrer-when-downgrade",Server:"CLOUD ELB 1.0.0",Vary:"Accept-Encoding","X-Cache-Lookup":"Cache Miss","x-cdn-provider":"tencent"},r=JSON.stringify({success:!0,is_vip:!0,kw_min_length:2,kw_max_length:100,kw_max_count:keywordMaxCount,data:e});i=$.env.isQuanX?{body:r,headers:t,status:"HTTP/1.1 200 OK"}:{response:{body:r,headers:t,status:200}},$.logger.debug(`获取本地脚本屏蔽关键词：
`+e.join("、"))}else if("POST"===$.request.method){if($.request.body){var e,n,s={"Cache-Control":"no-cache, no-store, must-revalidate, private, max-age=0",Connection:"keep-alive","Content-Type":"application/json;charset=utf-8",Pragma:"no-cache","Referrer-Policy":"no-referrer-when-downgrade",Server:"CLOUD ELB 1.0.0",Vary:"Accept-Encoding","X-Cache-Lookup":"Cache Miss","x-cdn-provider":"tencent"},a=decodeURIComponent($.request.body).match(/keyword=(.*)/)[1];let t=$.data.read(keywordBlockKey,null,o.id),r=(t=t||[],!1);for(let e=0;e<t.length;e++)if(a===t[e]){r=!0;break}!1===r?(t.push(a),$.data.write(keywordBlockKey,t,o.id),e=JSON.stringify({success:!0}),i=$.env.isQuanX?{body:e,headers:s,status:"HTTP/1.1 200 OK"}:{response:{body:e,headers:s,status:200}},$.logger.debug(`添加本地脚本屏蔽关键词“${a}”`)):(n=JSON.stringify({error:{message:"关键词已存在",code:100002}}),i=$.env.isQuanX?{body:n,headers:s,status:"HTTP/1.1 400 Bad Request"}:{response:{body:n,headers:s,status:400}})}}else if("DELETE"===$.request.method){let t=decodeURIComponent($.request.url).match(/keyword=(.*)/)[1],e=$.data.read(keywordBlockKey,null,o.id);e=(e=e||[]).filter(e=>e!==t),$.data.write(keywordBlockKey,e,o.id);var l={"Cache-Control":"no-cache, no-store, must-revalidate, private, max-age=0",Connection:"keep-alive","Content-Type":"application/json;charset=utf-8",Pragma:"no-cache","Referrer-Policy":"no-referrer-when-downgrade",Server:"CLOUD ELB 1.0.0",Vary:"Accept-Encoding","X-Cache-Lookup":"Cache Miss","x-cdn-provider":"tencent"},d=JSON.stringify({success:!0});i=$.env.isQuanX?{body:d,headers:l,status:"HTTP/1.1 200 OK"}:{response:{body:d,headers:l,status:200}},$.logger.debug(`删除本地脚本屏蔽关键词：“${t}”`)}}catch(e){$.logger.debug("知乎关键词屏蔽操作出现异常："+e)}return i}function removeHotSearchAds(){let e=null;try{var t;$.response.body&&((t=JSON.parse($.response.body)).commercial_data=[],e={body:JSON.stringify(t)})}catch(e){$.logger.error("去除知乎热搜广告出现异常："+e)}return e}function modifyAppConfig(){let e=null;try{var t,r;$.response.body&&(r=(t=JSON.parse($.response.body)).config.homepage_feed_tab.tab_infos.filter(e=>"activity_tab"===e.tab_type&&(e.end_time=(Date.parse(new Date)-12e4).toString().substr(0,10),!0)),t.config.homepage_feed_tab.tab_infos=r,t.config.zvideo_max_number=1,delete t.config.hp_channel_tab,t.config.gray_mode.enable=!1,t.config.gray_mode.start_time="4092566400",t.config.gray_mode.end_time="4092566400",delete t.config.soso_des,delete t.config.cronet,t.config.hasOwnProperty("zhcnh_thread_sync")&&($.logger.debug(JSON.stringify(t.config.zhcnh_thread_sync)),t.config.zhcnh_thread_sync.LocalDNSSetHostWhiteList=[],t.config.zhcnh_thread_sync.isOpenLocalDNS="0",t.config.zhcnh_thread_sync.ZHBackUpIP_Switch_Open="0",t.config.zhcnh_thread_sync.dns_ip_detector_operation_lock="1",t.config.zhcnh_thread_sync.ZHHTTPSessionManager_setupZHHTTPHeaderField="1"),e={body:JSON.stringify(t)})}catch(e){$.logger.error("优化知乎软件配置出现异常："+e)}return e}function removeKeywordAds(){let e=null;try{var t,r;$.response.body&&($.logger.debug("预置关键字返回："+$.response.body),(t=JSON.parse($.response.body)).hasOwnProperty("preset_words"))&&t.preset_words.words&&(r=t.preset_words.words.filter(e=>"ad"!==e.type),t.preset_words.words=r,e={body:JSON.stringify(t)})}catch(e){$.logger.error("知乎去除预置关键字广告出现异常："+e)}return e}function removeSysMsgAds(){let e=null;try{const i=["知乎小伙伴","知乎视频","知乎团队","知乎礼券","知乎读书会团队"];var t=JSON.parse($.response.body),r=t.data.filter(e=>i.indexOf(e.content.title)<0);t.data=r,e={body:JSON.stringify(t)}}catch(e){$.logger.error("知乎拦截官方账号推广消息出现异常："+e)}return e}function removeHotListAds(){let e=null;try{var t,r;$.response.body&&("data"in(t=JSON.parse($.response.body))&&(r=t.data.filter(e=>"hot_list_feed"===e.type||"hot_list_feed_video"===e.type),t.data=r),e={body:JSON.stringify(t)})}catch(e){$.logger.error("去除知乎热榜广告出现异常："+e)}return e}function removeCommentAds(){let e=null;try{if($.response.body){let n=JSON.parse($.response.body);if(0!=$.data.read("zhihu_settings_blocked_users")){var t=getUserInfo();let i=$.data.read(blockedUsersKey,"",t.id),o=[];n.data.forEach(r=>{var e=r.author.member.name;let t="";if(r.reply_to_author&&r.reply_to_author.member&&r.reply_to_author.member.name&&(t=r.reply_to_author.member.name),i[e]||i[t])i[e]&&!t&&0<$.request.url.indexOf("root_comment")?$.notification.debug(`屏蔽黑名单用户“${e}”的主评论。`):i[e]&&!t&&0<$.request.url.indexOf("child_comment")?$.notification.debug(`屏蔽黑名单用户“${e}”的子评论。`):i[e]&&t&&0<$.request.url.indexOf("child_comment")?$.notification.debug(`屏蔽黑名单用户“${e}”回复“${t}”的子评论。`):$.notification.debug(`屏蔽“${e}”回复黑名单用户“${t}”的子评论。`),n.common_counts&&--n.common_counts,n.paging&&n.paging.totals&&--n.paging.totals;else{if(r.child_comments){let t=[];r.child_comments.forEach(e=>{i[e.author.member.name]||i[e.reply_to_author.member.name]?(i[e.author.member.name]?$.notification.debug(`屏蔽黑名单用户“${e.author.member.name}”的主评论。`):$.notification.debug(`屏蔽“${e.author.member.name}”回复黑名单用户“${e.reply_to_author.member.name}”的子评论。`),--r.child_comment_count):t.push(e)}),r.child_comments=t}o.push(r)}}),n.data=o}e={body:JSON.stringify(n)}}}catch(e){$.logger.error("去除知乎评论广告出现异常："+e)}return e}function removeCommentV5Ads(){let e=null;try{if($.response.body){let s=JSON.parse($.response.body);if(s.ad_info={},0!=$.data.read("zhihu_settings_blocked_users")){var t=getUserInfo();let o=$.data.read(blockedUsersKey,"",t.id),r=(o=o||{},[]),n={};s.data.forEach(i=>{var e=i.author.name;let t="";if(i.reply_to_author&&i.reply_to_author&&i.reply_to_author.name&&(t=i.reply_to_author.name),o[e]||o[t])o[e]&&!t&&0<$.request.url.indexOf("root_comment")?$.notification.debug(`屏蔽黑名单用户“${e}”的主评论。`):o[e]&&!t&&0<$.request.url.indexOf("child_comment")?$.notification.debug(`屏蔽黑名单用户“${e}”的子评论。`):o[e]&&t&&0<$.request.url.indexOf("child_comment")?$.notification.debug(`屏蔽黑名单用户“${e}”回复“${t}”的子评论。`):$.notification.debug(`屏蔽“${e}”回复黑名单用户“${t}”的子评论。`),n[i.id]=e,s.counts&&s.counts.total_counts&&--s.counts.total_counts,s.paging&&s.paging.totals&&--s.paging.totals,s.root&&s.root.child_comment_count&&--s.root.child_comment_count;else{if(i.child_comments){let r=[];i.child_comments.forEach(e=>{var t=e.author.name;o[t]||n[e.reply_comment_id]?(o[t]?($.notification.debug(`屏蔽黑名单用户“${t}”的子评论。`),n[e.id]=t):$.notification.debug(`屏蔽“${t}”回复黑名单用户“${n[e.reply_comment_id]}”的子评论。`),--i.child_comment_count):r.push(e)}),i.child_comments=r}r.push(i)}}),s.data=r}e={body:JSON.stringify(s)}}}catch(e){$.logger.error("去除知乎评论广告出现异常："+e)}return e}function removeQuestionsAds(){let e=null;try{var t=getUserInfo();let r=$.data.read(blockedUsersKey,"",t.id);r=r||{};var i=JSON.parse($.response.body);if($.logger.debug("当前黑名单列表: "+JSON.stringify(r)),delete i.ad_info,delete i.roundtable_info,"data"in i){delete i.data.ad_info;let e=i.data.data||i.data;e=e.filter(e=>{let t="";try{"author"in e?t=e.author.name:"target"in e&&(t=e.target.author.name)}catch(e){$.logger.error("获取回答列表用户名出现异常："+err)}return""==t||!r[t]}),i.data.hasOwnProperty("data")?i.data.data=e:i.data=e}var o=JSON.stringify(i);$.logger.debug("修改后的回答列表数据："+o),e={body:o}}catch(e){$.logger.error("知乎回答列表去广告出现异常："+e)}return e}function removeMomentsAds(){let e=null;try{var t=JSON.parse($.response.body.replace(/(\w+"+\s?):\s?(\d{15,})/g,'$1:"$2"')),r=getUserInfo(),i=$.data.read(blockedUsersKey,"",r.id)||{},o=[],n=1==$.data.read("zhihu_settings_moments_stream"),s=0!=$.data.read("zhihu_settings_blocked_users");for(let e=0;e<t.data.length;e++){var a=t.data[e];a.ad||a.adjson||a.ad_list||(s&&a.target&&a.target.origin_pin&&a.target.origin_pin.author&&i[a.target.origin_pin.author.name]?$.notification.debug(`屏蔽“${a.target.author.name}”转发黑名单用户“${a.target.origin_pin.author.name}”的想法。`):n&&"videos"==a.type||o.push(a))}t.data=o,e={body:JSON.stringify(t)}}catch(e){$.logger.error("知乎关注列表去广告出现异常："+e)}return e}function removeRecommendAds(){let e=null;try{$.data.read("zhihu_settings_remove_yanxuan");const u=1==$.data.read("zhihu_settings_recommend_stream"),p=1==$.data.read("zhihu_settings_remove_article"),h=0!=$.data.read("zhihu_settings_blocked_keywords"),f=0!=$.data.read("zhihu_settings_blocked_users");var t=getUserInfo();let c=$.data.read(keywordBlockKey,"",t.id),g=(c=h&&c?c:[],$.data.read(blockedUsersKey,"",t.id));g=f&&g?g:{};var r=JSON.parse($.response.body.replace(/(\w+"+\s?):\s?(\d{15,})/g,'$1:"$2"'));r.data=r.data.filter(r=>{var e=JSON.stringify(r),t="slot_event_card"===r.card_type||"slot_video_event_card"===r.card_type||r.hasOwnProperty("ad")||r.extra&&"Training"===r.extra.type,i=1!=t&&0<=e.search(/"(type|style)+"\s?:\s?"(drama|zvideo|Video|BIG_IMAGE)+"/i),o=i&&u,n=0<=e.search(/"(type|style)+"\s?:\s?"article"/i)&&p;let s=!1;if(1!=i&&h)for(let t=0;t<c.length;t++)if(0<=e.search(c[t])){if($.isDebug){var a=r.common_card.feed_content.title.panel_text,l=r.common_card.feed_content.content.panel_text;let e="";try{e=r.common_card.feed_content.title.action.intent_url}catch{}$.logger.debug(`匹配关键字：
${c[t]}
标题：
${a}
内容：
`+l),$.notification.debug(scriptName,"关键字："+c[t],a+`
`+l,e)}s=!0;break}let d=!1;try{d=1!=s&&f&&g&&r.common_card.feed_content.source_line.elements[1].text.panel_text in g}catch{d=!1}return!(t||o||s||d||n)}),e={body:JSON.stringify(r)}}catch(e){$.logger.error("知乎推荐列表去广告出现异常："+e)}return e}function autoInsertBlackList(){let e=null;try{var t,r,i=JSON.parse($.response.body);delete i.mcn_user_info,e={body:JSON.stringify(i)},i.name&&i.id&&!0===i.is_blocking&&(t=getUserInfo(),(r="object"==typeof(r=$.data.read(blockedUsersKey,"",t.id))&&r?r:{})[i.name]||($.logger.debug(`当前需要加入黑名单的用户Id：${i.id}，用户名：`+i.name),r[i.name]=i.id,$.data.write(blockedUsersKey,r,t.id),$.logger.debug(i.name+"写入脚本黑名单成功，当前脚本黑名单数据："+JSON.stringify(r)),$.notification.post(`已自动将用户“${i.name}”写入脚本黑名单。`)))}catch(e){$.logger.error("知乎去除MCN信息出现异常："+e)}return e}function processUserInfo(){let e=null;try{var t,r=JSON.parse($.response.body);$.logger.debug("用户登录用户信息，接口响应："+$.response.body),r&&r.id&&r.hasOwnProperty("vip_info")&&r.vip_info.hasOwnProperty("is_vip")?(t={id:r.id,is_vip:!!r.vip_info.is_vip&&void 0!==r.vip_info.is_vip},$.logger.debug(`当前用户id：${r.id}，是否为VIP：`+r.vip_info.is_vip),$.data.write(currentUserInfoKey,t),0!=$.data.read("zhihu_settings_fake_vip")&&!1===r.vip_info.is_vip&&(r.vip_info.is_vip=!0,r.vip_info.vip_icon={url:"https://pic1.zhimg.com/v2-4812630bc27d642f7cafcd6cdeca3d7a_r.png",night_mode_url:"https://pic1.zhimg.com/v2-c9686ff064ea3579730756ac6c289978_r.png"},r.vip_info.entrance={icon:{url:"https://pic1.zhimg.com/v2-5b7012c8c22fd520f5677305e1e551bf.png",night_mode_url:"https://pic1.zhimg.com/v2-e51e3252d7a2cb016a70879defd5da0b.png"},title:"我的盐选会员",expires_day:"2033-12-24",sub_title:null,button_text:"你好，知乎！",jump_url:"zhihu://vip/purchase",button_jump_url:"zhihu://vip/purchase",sub_title_new:null,identity:"svip"},r.vip_info.entrance_new={left_button:{title:"精选会员内容",description:"为您严选好内容",jump_url:"zhihu://market/home"},right_button:{title:"我的盐选会员",description:"畅享 10w+ 优质内容",jump_url:"zhihu://vip/my"}},r.vip_info.entrance_v2={title:"我的盐选会员",sub_title:"畅享 10w+ 优质内容",jump_url:"zhihu://vip/my",button_text:"查看权益"},e={body:JSON.stringify(r)})):$.logger.warning("没有获取到本次登录用户信息，如未对功能造成影响，请忽略此日志。")}catch(e){$.logger.error("知乎获取当前用户信息出现异常："+e)}return e}function modifyAnswer(){let e=null;try{var t,r,i,o,n,s,a,l,d=$.response.body;(0<=d.indexOf("查看完整内容")||0<=d.indexOf("查看全部章节"))&&0<=d.indexOf("paid")?(t=d.match(/(richText[^<]*>)(.)/)[1],r=d.lastIndexOf(t)+t.length,e={body:d.slice(0,r)+'<a style="height: 42px;padding: 0 12px;border-radius: 6px;background-color: rgb(247 104 104 / 8%);display: block;text-decoration: none;" href="#"><div style="color: #f36;display: flex;-webkit-box-align: center;align-items: center;height: 100%;"><svg style="width: 1.2em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1957"><path d="M821.333333 138.666667c64.8 0 117.333333 52.533333 117.333334 117.333333v149.333333a32 32 0 0 1-32 32 74.666667 74.666667 0 0 0 0 149.333334 32 32 0 0 1 32 32v149.333333c0 64.8-52.533333 117.333333-117.333334 117.333333H202.666667c-64.8 0-117.333333-52.533333-117.333334-117.333333V618.666667a32 32 0 0 1 32-32 74.666667 74.666667 0 0 0 0-149.333334 32 32 0 0 1-32-32V256c0-64.8 52.533333-117.333333 117.333334-117.333333h618.666666zM428.576 329.994667a32 32 0 0 0-43.733333-2.581334l-1.514667 1.344a32 32 0 0 0-2.581333 43.733334L452.565333 458.666667H405.333333l-1.877333 0.053333A32 32 0 0 0 373.333333 490.666667l0.053334 1.877333A32 32 0 0 0 405.333333 522.666667h80v42.666666H405.333333l-1.877333 0.053334A32 32 0 0 0 373.333333 597.333333l0.053334 1.877334A32 32 0 0 0 405.333333 629.333333h80v42.666667l0.053334 1.877333A32 32 0 0 0 517.333333 704l1.877334-0.053333A32 32 0 0 0 549.333333 672v-42.666667H618.666667l1.877333-0.053333A32 32 0 0 0 650.666667 597.333333l-0.053334-1.877333A32 32 0 0 0 618.666667 565.333333h-69.333334v-42.666666H618.666667l1.877333-0.053334A32 32 0 0 0 650.666667 490.666667l-0.053334-1.877334A32 32 0 0 0 618.666667 458.666667h-47.253334l71.84-86.186667 1.248-1.589333a32 32 0 0 0-50.421333-39.381334L512 430.016l-82.08-98.506667z" p-id="1958"></path></svg><div style="flex: 1 1;white-space: nowrap;text-overflow: ellipsis;padding-left:4px"><span style="font-family: -apple-system,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Microsoft YaHei,Source Han Sans SC,Noto Sans CJK SC,WenQuanYi Micro Hei,sans-serif;-webkit-tap-highlight-color: rgba(26,26,26,0);font-size: 14px;line-height: 20px;color: #f36;white-space: nowrap;font-weight: 600;">知乎助手 · 本文为付费内容</span></div><div><span style="font-family: -apple-system,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Microsoft YaHei,Source Han Sans SC,Noto Sans CJK SC,WenQuanYi Micro Hei,sans-serif;-webkit-tap-highlight-color: rgba(26,26,26,0);font-size: 14px;color: #f36;line-height: normal;display: flex;-webkit-box-align: center;align-items: center;"><svg style="font-family: -apple-system,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Microsoft YaHei,Source Han Sans SC,Noto Sans CJK SC,WenQuanYi Micro Hei,sans-serif;-webkit-tap-highlight-color: rgba(26,26,26,0);font-size: 14px;color: #f36;line-height: normal;fill: currentcolor;width: 24px;height: 24px;margin: -2px;" fill="currentColor" viewBox="0 0 24 24" width="24" height="24"><path d="M9.218 16.78a.737.737 0 0 0 1.052 0l4.512-4.249a.758.758 0 0 0 0-1.063L10.27 7.22a.737.737 0 0 0-1.052 0 .759.759 0 0 0-.001 1.063L13 12l-3.782 3.716a.758.758 0 0 0 0 1.063z" fill-rule="evenodd"></path></svg></span></div></div></a>'+d.slice(r)}):0<=d.indexOf("ad-link-card")||0<=d.indexOf("xg.zhihu.com")||0<=d.indexOf("知乎营销平台")?(i=d.match(/(richText[^<]*>)(.)/)[1],o=d.lastIndexOf(i)+i.length,e={body:d.slice(0,o)+'<a style="height: 42px;padding: 0 12px;border-radius: 6px;background-color: rgb(8 188 212 / 8%);display: block;text-decoration: none;" href="#"><div style="color: #00bcd4;display: flex;-webkit-box-align: center;align-items: center;height: 100%;"><svg style="width: 1.2em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1957"><path d="M128 765.952q0 26.624 18.432 45.056t45.056 18.432l191.488 0 0 128-254.976 0q-26.624 0-49.664-10.24t-40.448-27.648-27.648-40.448-10.24-49.664l0-637.952q0-25.6 10.24-49.152t27.648-40.448 40.448-27.136 49.664-10.24l701.44 0q26.624 0 49.664 10.24t40.448 27.136 27.648 40.448 10.24 49.152l0 251.904-128 1.024 0-61.44q0-26.624-18.432-45.056t-45.056-18.432l-574.464 0q-26.624 0-45.056 18.432t-18.432 45.056l0 382.976zM990.208 705.536q21.504 18.432 22.016 34.304t-20.992 33.28q-21.504 18.432-51.2 41.472t-60.928 48.128-61.952 49.152-55.296 43.52q-26.624 20.48-43.52 15.36t-16.896-31.744q1.024-16.384 0-40.448t-1.024-41.472q0-19.456-10.752-24.064t-31.232-4.608q-21.504 0-39.936-0.512t-35.84-0.512-36.352-0.512-41.472-0.512q-9.216 0-19.968-2.048t-19.456-7.168-14.336-15.36-5.632-27.648l0-80.896q0-31.744 15.36-42.496t48.128-10.752q30.72 1.024 61.44 1.024t71.68 1.024q29.696 0 46.08-5.12t16.384-25.6q-1.024-14.336 0.512-35.328t1.536-37.376q0-26.624 14.336-33.28t36.864 10.752q22.528 18.432 52.736 43.008t61.952 50.688 62.976 51.2 54.784 44.544z" p-id="5859"></path></svg><div style="flex: 1 1;white-space: nowrap;text-overflow: ellipsis;padding-left:4px"><span style="font-family: -apple-system,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Microsoft YaHei,Source Han Sans SC,Noto Sans CJK SC,WenQuanYi Micro Hei,sans-serif;-webkit-tap-highlight-color: rgba(26,26,26,0);font-size: 14px;line-height: 20px;color: #00bcd4;white-space: nowrap;font-weight: 600;">知乎助手 · 本文含有营销推广</span></div><div><span style="font-family: -apple-system,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Microsoft YaHei,Source Han Sans SC,Noto Sans CJK SC,WenQuanYi Micro Hei,sans-serif;-webkit-tap-highlight-color: rgba(26,26,26,0);font-size: 14px;color: #f36;line-height: normal;display: flex;-webkit-box-align: center;align-items: center;"><svg style="font-family: -apple-system,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Microsoft YaHei,Source Han Sans SC,Noto Sans CJK SC,WenQuanYi Micro Hei,sans-serif;-webkit-tap-highlight-color: rgba(26,26,26,0);font-size: 14px;color: #00BCD4;line-height: normal;fill: currentcolor;width: 24px;height: 24px;margin: -2px;" fill="currentColor" viewBox="0 0 24 24" width="24" height="24"><path d="M9.218 16.78a.737.737 0 0 0 1.052 0l4.512-4.249a.758.758 0 0 0 0-1.063L10.27 7.22a.737.737 0 0 0-1.052 0 .759.759 0 0 0-.001 1.063L13 12l-3.782 3.716a.758.758 0 0 0 0 1.063z" fill-rule="evenodd"></path></svg></span></div></div></a>'+d.slice(o)}):0<=d.indexOf("mcn-link-card")?(n=d.match(/(richText[^<]*>)(.)/)[1],s=d.lastIndexOf(n)+n.length,e={body:d.slice(0,s)+'<a style="height: 42px;padding: 0 12px;border-radius: 6px;background-color: rgb(8 188 212 / 8%);display: block;text-decoration: none;" href="#"><div style="color: #00bcd4;display: flex;-webkit-box-align: center;align-items: center;height: 100%;"><svg style="width: 1.2em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1957"><path d="M346.112 806.912q19.456 0 36.864 7.168t30.208 19.968 20.48 30.208 7.68 36.864-7.68 36.864-20.48 30.208-30.208 20.48-36.864 7.68q-20.48 0-37.888-7.68t-30.208-20.48-20.48-30.208-7.68-36.864 7.68-36.864 20.48-30.208 30.208-19.968 37.888-7.168zM772.096 808.96q19.456 0 37.376 7.168t30.72 19.968 20.48 30.208 7.68 36.864-7.68 36.864-20.48 30.208-30.72 20.48-37.376 7.68-36.864-7.68-30.208-20.48-20.48-30.208-7.68-36.864 7.68-36.864 20.48-30.208 30.208-19.968 36.864-7.168zM944.128 227.328q28.672 0 44.544 7.68t22.528 18.944 6.144 24.064-3.584 22.016-13.312 37.888-22.016 62.976-23.552 68.096-18.944 53.248q-13.312 40.96-33.28 56.832t-49.664 15.872l-35.84 0-65.536 0-86.016 0-96.256 0-253.952 0 14.336 92.16 517.12 0q49.152 0 49.152 41.984 0 20.48-9.728 35.328t-38.4 14.848l-49.152 0-94.208 0-118.784 0-119.808 0-99.328 0-55.296 0q-20.48 0-34.304-9.216t-23.04-24.064-14.848-32.256-8.704-32.768q-1.024-6.144-5.632-29.696t-11.264-58.88-14.848-78.848-16.384-87.552q-19.456-103.424-44.032-230.4l-76.8 0q-15.36 0-25.6-7.68t-16.896-18.432-9.216-23.04-2.56-22.528q0-20.48 13.824-33.792t37.376-13.312l21.504 0 21.504 0 25.6 0 34.816 0q20.48 0 32.768 6.144t19.456 15.36 10.24 19.456 5.12 17.408q2.048 8.192 4.096 23.04t4.096 30.208q3.072 18.432 6.144 38.912l700.416 0zM867.328 194.56l-374.784 0 135.168-135.168q23.552-23.552 51.712-24.064t51.712 23.04z"></path></svg><div style="flex: 1 1;white-space: nowrap;text-overflow: ellipsis;padding-left:4px"><span style="font-family: -apple-system,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Microsoft YaHei,Source Han Sans SC,Noto Sans CJK SC,WenQuanYi Micro Hei,sans-serif;-webkit-tap-highlight-color: rgba(26,26,26,0);font-size: 14px;line-height: 20px;color: #00bcd4;white-space: nowrap;font-weight: 600;">知乎助手 · 本文含有购物推广</span></div><div><span style="font-family: -apple-system,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Microsoft YaHei,Source Han Sans SC,Noto Sans CJK SC,WenQuanYi Micro Hei,sans-serif;-webkit-tap-highlight-color: rgba(26,26,26,0);font-size: 14px;color: #f36;line-height: normal;display: flex;-webkit-box-align: center;align-items: center;"><svg style="font-family: -apple-system,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Microsoft YaHei,Source Han Sans SC,Noto Sans CJK SC,WenQuanYi Micro Hei,sans-serif;-webkit-tap-highlight-color: rgba(26,26,26,0);font-size: 14px;color: #00BCD4;line-height: normal;fill: currentcolor;width: 24px;height: 24px;margin: -2px;" fill="currentColor" viewBox="0 0 24 24" width="24" height="24"><path d="M9.218 16.78a.737.737 0 0 0 1.052 0l4.512-4.249a.758.758 0 0 0 0-1.063L10.27 7.22a.737.737 0 0 0-1.052 0 .759.759 0 0 0-.001 1.063L13 12l-3.782 3.716a.758.758 0 0 0 0 1.063z" fill-rule="evenodd"></path></svg></span></div></div></a>'+d.slice(s)}):7==Math.floor(200*Math.random())&&(a=d.match(/(richText[^<]*>)(.)/)[1],l=d.lastIndexOf(a)+a.length,e={body:d.slice(0,l)+'<a style="height: 42px;padding: 0 12px;border-radius: 6px;background-color: rgb(74 162 56 / 8%);display: block;text-decoration: none;" href="#"><div style="color: #619201;display: flex;-webkit-box-align: center;align-items: center;height: 100%;"><svg class="icon" style="width: 1.2em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1465"><path d="M512 85.333333c71.477333 0 159.68 57.546667 229.258667 147.018667C817.845333 330.826667 864 455.978667 864 586.666667c0 211.808-148.501333 352-352 352S160 798.474667 160 586.666667c0-130.688 46.144-255.84 122.741333-354.314667C352.32 142.88 440.522667 85.333333 512 85.333333z m0 64c-48.213333 0-120.096 46.912-178.741333 122.314667C265.109333 359.253333 224 470.762667 224 586.666667c0 175.616 119.050667 288 288 288s288-112.384 288-288c0-115.904-41.109333-227.402667-109.258667-315.018667C632.096 196.234667 560.213333 149.333333 512 149.333333z m-74.666667 522.666667a53.333333 53.333333 0 1 1 0 106.666667 53.333333 53.333333 0 0 1 0-106.666667z m-96-128a42.666667 42.666667 0 1 1 0 85.333333 42.666667 42.666667 0 0 1 0-85.333333z" p-id="1466"></path></svg><div style="flex: 1 1;white-space: nowrap;text-overflow: ellipsis;padding-left:4px"><span style="font-family: -apple-system,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Microsoft YaHei,Source Han Sans SC,Noto Sans CJK SC,WenQuanYi Micro Hei,sans-serif;-webkit-tap-highlight-color: rgba(26,26,26,0);font-size: 14px;line-height: 20px;color: #619201;white-space: nowrap;font-weight: 600;">知乎助手 · 本文为免费内容</span></div><div><span style="font-family: -apple-system,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Microsoft YaHei,Source Han Sans SC,Noto Sans CJK SC,WenQuanYi Micro Hei,sans-serif;-webkit-tap-highlight-color: rgba(26,26,26,0);font-size: 14px;color: #619201;line-height: normal;display: flex;-webkit-box-align: center;align-items: center;"><svg style="font-family: -apple-system,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Microsoft YaHei,Source Han Sans SC,Noto Sans CJK SC,WenQuanYi Micro Hei,sans-serif;-webkit-tap-highlight-color: rgba(26,26,26,0);font-size: 14px;color: #619201;line-height: normal;fill: currentcolor;width: 24px;height: 24px;margin: -2px;" fill="currentColor" viewBox="0 0 24 24" width="24" height="24"><path d="M9.218 16.78a.737.737 0 0 0 1.052 0l4.512-4.249a.758.758 0 0 0 0-1.063L10.27 7.22a.737.737 0 0 0-1.052 0 .759.759 0 0 0-.001 1.063L13 12l-3.782 3.716a.758.758 0 0 0 0 1.063z" fill-rule="evenodd"></path></svg></span></div></div></a>'+d.slice(l)})}catch(e){$.logger.error("知乎付费内容提醒出现异常："+e)}return e}function manageBlackUser(){var e=getUserInfo();let t={},r=$.data.read(blockedUsersKey,"",e.id);if(r="object"==typeof r&&r?r:{},defaultAnswerBlockedUsers.forEach(e=>{r[e]="00000000000000000000000000000000",t[e]="00000000000000000000000000000000"}),$.logger.debug(`当前用户id：${e.id}，脚本黑名单：`+JSON.stringify(r)),"GET"==$.request.method)try{$.request.url.indexOf("offset")<0&&(r=t,$.logger.debug("脚本黑名单已清空，请滑动至黑名单末尾保证重新获取完成。"),$.notification.post("脚本黑名单已清空，请滑动至黑名单末尾保证重新获取完成。"));var i=JSON.parse($.response.body);i.data?($.logger.debug("本次滑动获取的黑名单信息："+JSON.stringify(i.data)),i.data.forEach(e=>{"[已重置]"!=e.name&&(r[e.name]=e.id)}),$.data.write(blockedUsersKey,r,e.id),1==i.paging.is_end&&($.notification.post(`获取脚本黑名单结束，当前黑名单共${Object.keys(r).length-defaultAnswerBlockedUsers.length}人。
脚本内置黑名单${defaultAnswerBlockedUsers.length}人。`),$.logger.debug(`脚本黑名单内容：${JSON.stringify(r)}。`))):$.logger.warning("获取黑名单失败，接口响应不合法："+$.response.body)}catch(e){$.data.del(blockedUsersKey),$.logger.error("获取黑名单失败，异常信息："+e),$.notification.post("获取黑名单失败，执行异常，已清空黑名单。")}else if("POST"==$.request.method)try{var o=JSON.parse($.response.body);o.hasOwnProperty("name")&&o.hasOwnProperty("id")?($.logger.debug(`当前需要加入黑名单的用户Id：${o.id}，用户名：`+o.name),o.id?(r[o.name]=o.id,$.data.write(blockedUsersKey,r,e.id),$.logger.debug(o.name+"写入脚本黑名单成功，当前脚本黑名单数据："+JSON.stringify(r)),$.notification.post(`已将用户“${o.name}”写入脚本黑名单。`)):($.logger.error(o.name+"写入脚本黑名单失败，没有获取到用户Id。"),$.notification.post(`将用户“${o.name}”写入脚本黑名单失败！`))):($.logger.warning("写入黑名单失败，接口响应不合法："+$.response.body),$.notification.post("写入脚本黑名单失败，接口返回不合法。"))}catch(e){$.logger.error("写入黑名单失败，异常信息："+e),$.notification.post("写入脚本黑名单失败，执行异常，请查阅日志。")}else if("DELETE"==$.request.method)try{if(JSON.parse($.response.body).success){var n=$.request.url.match(/https?:\/\/(api\.zhihu\.com|(103\.41\.167\.(226|234|235|236)))\/settings\/blocked_users\/([0-9a-zA-Z]*)/)[1];if(n){for(var s in $.logger.debug("当前需要移出黑名单的用户Id："+n),r)if(r[s]==n){delete r[s],$.data.write(blockedUsersKey,r,e.id),$.logger.debug(s+"移出脚本黑名单成功，当前脚本黑名单数据："+JSON.stringify(r)),$.notification.post(`已将用户“${s}”移出脚本黑名单！`);break}}else $.logger.error("将用户移出脚本黑名单失败！\n建议从设置中刷新黑名单数据。"),$.notification.post(`将用户移出脚本黑名单失败，没有获取到用户Id。
建议从设置中刷新黑名单数据。`)}else $.logger.warning("移出黑名单失败，接口响应不合法："+$.response.body),$.notification.post("移出脚本黑名单失败，接口返回不合法。")}catch(e){$.logger.error("移出黑名单失败，异常信息："+e),$.notification.post("移出脚本黑名单失败，执行异常，请查阅日志。")}}function getUserInfo(){var t={id:"default",is_vip:!1};try{const e=$.data.read(currentUserInfoKey);return(e="string"==typeof e?JSON.parse(e):e)&&e.hasOwnProperty("id")?e:t}catch(e){return $.logger.error("获取用户信息出现异常："+e),t}}function removeFeedSections(){let e=null;try{var t=JSON.parse($.response.body);t.guess_like_sections=[],t.selected_sections=[],t.more_sections=[],e={body:JSON.stringify(t)}}catch(e){$.logger.error("知乎移除推荐页顶部项出现异常："+e)}return e}function MagicJS(e="MagicJS",t="INFO"){const r=()=>{const e="undefined"!=typeof $loon,t="undefined"!=typeof $task,r="undefined"!=typeof module,i="undefined"!=typeof $httpClient&&!e,o="undefined"!=typeof $storm,n="undefined"!=typeof $environment&&void 0!==$environment["stash-build"];var s=i||e||o||n;const a="undefined"!=typeof importModule;return{isLoon:e,isQuanX:t,isNode:r,isSurge:i,isStorm:o,isStash:n,isSurgeLike:s,isScriptable:a,get name(){return e?"Loon":t?"QuantumultX":r?"NodeJS":i?"Surge":a?"Scriptable":"unknown"},get build(){return i?$environment["surge-build"]:n?$environment["stash-build"]:o?$storm.buildVersion:void 0},get language(){if(i||n)return $environment.language},get version(){return i?$environment["surge-version"]:n?$environment["stash-version"]:o?$storm.appVersion:r?process.version:void 0},get system(){return i?$environment.system:r?process.platform:void 0},get systemVersion(){if(o)return $storm.systemVersion},get deviceName(){if(o)return $storm.deviceName}}},i=(r,e="INFO")=>{let i=e;const o={SNIFFER:6,DEBUG:5,INFO:4,NOTIFY:3,WARNING:2,ERROR:1,CRITICAL:0,NONE:-1},n={SNIFFER:"",DEBUG:"",INFO:"",NOTIFY:"",WARNING:"❗ ",ERROR:"❌ ",CRITICAL:"❌ ",NONE:""},t=(e,t="INFO")=>{o[i]<o[t.toUpperCase()]||console.log(`[${t}] [${r}]
${n[t.toUpperCase()]}${e}
`)};return{setLevel:e=>{i=e},sniffer:e=>{t(e,"SNIFFER")},debug:e=>{t(e,"DEBUG")},info:e=>{t(e,"INFO")},notify:e=>{t(e,"NOTIFY")},warning:e=>{t(e,"WARNING")},error:e=>{t(e,"ERROR")},retry:e=>{t(e,"RETRY")}}};return new class{constructor(e,t){this._startTime=Date.now(),this.version="3.0.0",this.scriptName=e,this.env=r(),this.logger=i(e,t),this.http="function"==typeof MagicHttp?MagicHttp(this.env,this.logger):void 0,this.data="function"==typeof MagicData?MagicData(this.env,this.logger):void 0,this.notification="function"==typeof MagicNotification?MagicNotification(this.scriptName,this.env,this.logger):void 0,this.utils="function"==typeof MagicUtils?MagicUtils(this.env,this.logger):void 0,this.qinglong="function"==typeof MagicQingLong?MagicQingLong(this.env,this.data,this.logger):void 0,void 0!==this.data&&(e=this.data.read("magic_loglevel"),t=this.data.read("magic_bark_url"),e&&this.logger.setLevel(e.toUpperCase()),t)&&this.notification.setBark(t)}get isRequest(){return"undefined"!=typeof $request&&"undefined"==typeof $response}get isResponse(){return"undefined"!=typeof $response}get isDebug(){return"DEBUG"===this.logger.level}get request(){if("undefined"!=typeof $request)return this.logger.sniffer(`RESPONSE:
`+JSON.stringify($request)),$request}get response(){if("undefined"!=typeof $response)return $response.hasOwnProperty("status")&&($response.statusCode=$response.status),$response.hasOwnProperty("statusCode")&&($response.status=$response.statusCode),this.logger.sniffer(`RESPONSE:
`+JSON.stringify($response)),$response}done=(e={})=>{this._endTime=Date.now();var t=(this._endTime-this._startTime)/1e3;this.logger.info(`SCRIPT COMPLETED: ${t} S.`),"undefined"!=typeof $done&&$done(e)}}(e,t)}function MagicNotification(o,n,s){let a=null,l=null;const d="function"==typeof MagicHttp?MagicHttp(n,s):void 0;function c(e=o,t="",r="",i){if(void 0===d||void 0===d.post)throw"Bark notification needs to import MagicHttp module.";e={url:a,headers:{"Content-Type":"application/json; charset=utf-8"},body:{title:e,body:t?t+`
`+r:r,device_key:l}};d.post(e).catch(e=>{s.error("Bark notify error: "+e)})}return{post:function(e=o,t="",r="",i=""){i=(t=>{try{let e={};var r;return"string"==typeof t?n.isLoon?e={openUrl:t}:n.isQuanX?e={"open-url":t}:n.isSurge&&(e={url:t}):"object"==typeof t&&(n.isLoon?(e.openUrl=t["open-url"]||"",e.mediaUrl=t["media-url"]||""):n.isQuanX?e=t["open-url"]||t["media-url"]?t:{}:n.isSurge&&(r=t["open-url"]||t.openUrl,e=r?{url:r}:{})),e}catch(e){s.error("Failed to convert notification option, "+e)}return t})(i),1==arguments.length&&(e=o,t="",r=arguments[0]),s.notify(`title:${e}
subTitle:${t}
body:${r}
options:`+("object"==typeof i?JSON.stringify(i):i)),n.isSurge?$notification.post(e,t,r,i):n.isLoon?i?$notification.post(e,t,r,i):$notification.post(e,t,r):n.isQuanX&&$notify(e,t,r,i),a&&l&&void 0!==d&&c(e,t,r)},debug:function(e=o,t="",r="",i=""){"DEBUG"===s.level&&(1==arguments.length&&(e=o,t="",r=arguments[0]),this.notify(e,t,r,i))},bark:c,setBark:e=>{try{var t=e.replace(/\/+$/g,"");a=/^https?:\/\/([^/]*)/.exec(t)[0]+"/push",l=/\/([^\/]+)\/?$/.exec(t)[1]}catch(e){s.error(`Bark url error: ${e}.`)}}}}function MagicData(g,u){let p={fs:void 0,data:{}};if(g.isNode){p.fs=require("fs");try{p.fs.accessSync("./magic.json",p.fs.constants.R_OK|p.fs.constants.W_OK)}catch(e){p.fs.writeFileSync("./magic.json","{}",{encoding:"utf8"})}p.data=require("./magic.json")}const s=(e,t)=>"object"!=typeof t&&e===t,a=e=>"true"===e||"false"!==e&&(void 0===e?null:e),l=(e,t,r,i)=>{if(r)try{e=!0===(e="string"==typeof e?JSON.parse(e):e).magic_session?e[r]:null}catch{e=null}if("string"==typeof e&&"null"!==e)try{e=JSON.parse(e)}catch{}return null==(e=!1===i&&e&&!0===e.magic_session?null:e)&&null!=t&&(e=t),e=a(e)},h=t=>{if("string"!=typeof t)return t instanceof Array||null==t||t!=t||"boolean"==typeof t?{}:t;{let e={};try{var r=typeof(e=JSON.parse(t));("object"!=r||e instanceof Array||"bool"==r||null===e)&&(e={})}catch{}return e}},d=(e,t=null,r="",i=!1,o=null)=>{let n="";return n=o||g.isNode?((e,t=null,r="",i=!1,o=null)=>{o=o||p.data;return val=o&&void 0!==o[e]&&null!==o[e]?o[e]:r?{}:null,val=l(val,t,r,i)})(e,t,r,i,o):(g.isSurgeLike?n=$persistentStore.read(e):g.isQuanX&&(n=$prefs.valueForKey(e)),l(n,t,r,i)),u.debug(`READ DATA [${e}]${r?`[${r}]`:""} <${typeof n}>
`+JSON.stringify(n)),n},c=(e,t,r="",i=null)=>{if(void 0===t||t!=t)return!1;g.isNode||"boolean"!=typeof t&&"number"!=typeof t||(t=String(t));let o="";var n,s,a,l,d,c;if(i||g.isNode?o=([n,s,a="",l=null]=[e,t,r,i],c=l||p.data,c=h(c),a?((d=h(c[n])).magic_session=!0,d[a]=s,c[n]=d):c[n]=s,null!==l&&(l=c),c):r?(g.isSurgeLike?o=$persistentStore.read(e)?$persistentStore.read(e):o:g.isQuanX&&(o=$prefs.valueForKey(e)?$prefs.valueForKey(e):o),(o=h(o)).magic_session=!0,o[r]=t):o=t,o&&"object"==typeof o&&(o=JSON.stringify(o,"","\t")),u.debug(`WRITE DATA [${e}]${r?`[${r}]`:""} <${typeof t}>
`+JSON.stringify(t)),!i){if(g.isSurgeLike)return $persistentStore.write(o,e);if(g.isQuanX)return $prefs.setValueForKey(o,e);if(g.isNode)try{p.fs.writeFileSync("./magic.json",o)}catch(e){return u.error(e),!1}}return!0};return{read:d,write:c,del:(e,t="",r=null)=>{let i={};if(r||g.isNode)i=(o=e,n=t,s=r||p.data,s=h(s),n?(delete(obj=h(s[o]))[n],s[o]=obj):delete s[o],s),r?r=i:p.fs.writeFileSync("./magic.json",JSON.stringify(i));else if(t){g.isSurgeLike?i=$persistentStore.read(e):g.isQuanX&&(i=$prefs.valueForKey(e)),delete(i=h(i))[t];n=JSON.stringify(i);c(e,n)}else{if(g.isStorm)return $persistentStore.remove(e);if(g.isSurgeLike)return $persistentStore.write(null,e);if(g.isQuanX)return $prefs.removeValueForKey(e)}var o,n,s;u.debug(`DELETE KEY [${e}]`+(t?`[${t}]`:""))},update:(e,t,r,i=s,o=null)=>{var n;return t=a(t),!0!==i(d(e,null,r,!1,o),t)&&(n=c(e,t,r,o),e=d(e,null,r,!1,o),i===s&&"object"==typeof e?n:i(t,e))},allSessions:(e,t=null)=>{let r=[];t=d(e,null,null,!0,t),t=h(t);return r=!0!==t.magic_session?[]:Object.keys(t).filter(e=>"magic_session"!==e),u.debug(`READ ALL SESSIONS [${e}] <${typeof r}>
`+JSON.stringify(r)),r},defaultValueComparator:s,convertToObject:h}}(()=>{let e=null;if($.isResponse)switch(!0){case!0===$.data.read("zhihu_settings_remove_sections",!1)&&/^https?:\/\/(api\.zhihu\.com|(103\.41\.167\.(226|234|235|236)))\/feed-root\/sections\/query\/v2/.test($.request.url):e=removeFeedSections();break;case!0===$.data.read("zhihu_settings_answer_tip",!0)&&/^https?:\/\/(www\.zhihu\.com|(103\.41\.167\.(226|234|235|236)))\/appview\/v2\/answer\/.*(entry=(?!(preload-topstory|preload-search|preload-subscription)))?/.test($.request.url):e=modifyAnswer();break;case/^https:\/\/(api\.zhihu\.com|(103\.41\.167\.(226|234|235|236)))\/people\/self$/.test($.request.url):e=processUserInfo();break;case!0===$.data.read("zhihu_settings_blocked_users",!0)&&/^https?:\/\/(api\.zhihu\.com|(103\.41\.167\.(226|234|235|236)))\/people\/((?!self).)*$/.test($.request.url):e=autoInsertBlackList();break;case/^https:\/\/(api\.zhihu\.com|(103\.41\.167\.(226|234|235|236)))\/topstory\/recommend\?/.test($.request.url):e=removeRecommendAds();break;case/^https?:\/\/(api\.zhihu\.com|(103\.41\.167\.(226|234|235|236)))\/moments(\/|\?)?(recommend|action=|feed_type=)(?!\/people)/.test($.request.url):e=removeMomentsAds();break;case/^https?:\/\/(api\.zhihu\.com|(103\.41\.167\.(226|234|235|236)))\/(v4\/)?questions\/\d+/.test($.request.url):e=removeQuestionsAds();break;case/^https?:\/\/(api\.zhihu\.com|(103\.41\.167\.(226|234|235|236)))\/comment_v5\/(answers|pins|comments?|articles)\/\d+\/(root|child)_comment/.test($.request.url):e=removeCommentV5Ads();break;case/^https?:\/\/(api\.zhihu\.com|(103\.41\.167\.(226|234|235|236)))\/(answers|pins|comments?|articles)\/\d+\/(root|child)_comments/.test($.request.url):e=removeCommentAds();break;case!0===$.data.read("zhihu_settings_hot_list",!0)&&/^https?:\/\/(api\.zhihu\.com|(103\.41\.167\.(226|234|235|236)))\/topstory\/hot-lists?(\?|\/)/.test($.request.url):e=removeHotListAds();break;case!0===$.data.read("zhihu_settings_sys_msg",!0)&&/^https?:\/\/(api\.zhihu\.com|(103\.41\.167\.(226|234|235|236)))\/notifications\/v3\/timeline\/entry\/system_message/.test($.request.url):e=removeSysMsgAds();break;case 0!=$.data.read("zhihu_settings_sys_msg",!0)&&/^https?:\/\/(api\.zhihu\.com|(103\.41\.167\.(226|234|235|236)))\/notifications\/v3\/message/.test($.request.url):e=removeMarketingMsg();break;case 1==$.data.read("zhihu_settings_preset_words",!1)&&/^https?:\/\/(api\.zhihu\.com|(103\.41\.167\.(226|234|235|236)))\/search\/preset_words\?/.test($.request.url):e=removeKeywordAds();break;case 1==$.data.read("zhihu_settings_app_conf")&&/^https?:\/\/appcloud2\.zhihu\.com\/v\d+\/config/.test($.request.url):e=modifyAppConfig();break;case 1==$.data.read("zhihu_settings_hot_search")&&/^https?:\/\/(api\.zhihu\.com|(103\.41\.167\.(226|234|235|236)))\/search\/top_search\/tabs\/hot\/items/.test($.request.url):e=removeHotSearchAds();break;case 0!=$.data.read("zhihu_settings_blocked_users")&&/^https?:\/\/(api\.zhihu\.com|(103\.41\.167\.(226|234|235|236)))\/settings\/blocked_users/.test($.request.url):manageBlackUser()}else $.isRequest?0!=$.data.read("zhihu_settings_blocked_keywords")&&!0===/^https?:\/\/(api\.zhihu\.com|(103\.41\.167\.(226|234|235|236)))\/feed-root\/block/.test($.request.url)&&(e=unlockBlockedKeywords(e)):($.data.del(currentUserInfoKey),$.data.del(blockedUsersKey),$.data.del(keywordBlockKey),$.notification.post("知乎助手数据清理完毕"));e?$.done(e):$.done()})();